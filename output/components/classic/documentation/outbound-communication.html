<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ActiveMQ</title>
    <link rel="icon" type="image/png" href="/assets/img/favicon.png">

    <link rel="stylesheet" href="/css/main.css">
    <script defer src="/js/fontawesome-all.min.js" integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc"></script>
    <script src="/js/jquery.slim.min.js" integrity="sha384-5AkRS45j4ukf+JbWAfHL8P4onPA9p0KwwP7pUdjSQA3ss9edbJUJc/XcYAiheSSz"></script>
    <script src="/js/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"></script>
    <script src="/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"></script>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-light fixed-top">
    <div class="container">
        <!-- <a class="navbar-brand mr-auto" href="#"><img style="height: 50px" src="assets/img/apache-feather.png" /></a> -->
        <a class="navbar-brand mr-auto" href="/"><img src="/assets/img/activemq_logo_black_small.png" style="height: 50px"/></a>
        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="ml-auto collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link active" href="/news">News</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link" id="navbarDropdownComponents" data-target="#" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Components<span class="caret"></span></a>
                    <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="navbarDropdownComponents">
                        <div class="row">
                            <div class="col-12">
                                <ul class="multi-column-dropdown">
                                    <li class="nav-item"><a class="dropdown-item" href="/components/classic">ActiveMQ Classic</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/components/artemis/">ActiveMQ Artemis</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/components/artemis-console/">ActiveMQ Artemis Console</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/components/nms">NMS Clients</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/components/cms">CMS Client</a></li>
                                </ul>
                            </div>
                        </div>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link" id="navbarDropdownCommunity" data-target="#" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community<span class="caret"></span></a>
                    <ul class="dropdown-menu dropdown-menu-center multi-column columns-1" aria-labelledby="navbarDropdownCommunity">
                        <div class="row">
                            <div class="col-12">
                                <ul class="multi-column-dropdown">
                                    <li class="nav-item"><a class="dropdown-item" href="/contact">Contact Us</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/contributing">Contribute</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/issues">Report Issues</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/support">Get Support</a></li>
                                </ul>
                            </div>
                          </div>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link" id="navbarDropdownTeam" data-target="#" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="/assets/img/asf_logo_wide.png" style="height:25px"> <span class="caret"></span></a>
                    <ul class="dropdown-menu dropdown-menu-center multi-column columns-1" aria-labelledby="navbarDropdownTeam">
                        <div class="row">
                            <div class="col-sm-12">
                                <ul class="multi-column-dropdown">
                                    <li class="nav-item"><a class="dropdown-item" href="https://www.apache.org">The Apache Software Foundation</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://www.apache.org/licenses/">License</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="/security-advisories">Security</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://www.apache.org/events/current-event">Events</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://people.apache.org/phonebook.html?pmc=activemq">PMC & Committers</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://whimsy.apache.org/board/minutes/ActiveMQ.html">Board Reports</a></li>
                                    <li class="nav-item"><a class="dropdown-item" href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a></li>
                                </ul>
                            </div>
                        </div>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="content">
  <div class="page-title-classic">
    <div class="container">
      <h1>Outbound Communication</h1>
    </div>
  </div>
  <div class="container" >
    <div class="row" style="margin-top: 30px">
      <div class="col-12 classic">
        <p><a href="connectivity">Connectivity</a> &gt; <a href="containers">Containers</a> &gt; <a href="jboss-integration">JBoss Integration</a> &gt; <a href="JBoss Integration/outbound-communication">Outbound Communication</a></p>

<h2 id="configuring-a-session-bean-to-send-messages-to-activemq-classic">Configuring a Session Bean to send messages to ActiveMQ Classic</h2>

<p>In the attached <a href="outbound-communication.data/activemq-jboss-test.zip?version=3&amp;modificationDate=1117021355000&amp;api=v2">example application</a>, the three MDBs use the <code class="language-plaintext highlighter-rouge">SenderEJB</code> to send JMS messages to an ActiveMQ Classic queue. In this example, I will be explaining how to:</p>

<ol>
  <li>Configure and deploy an ActiveMQ Classic <code class="language-plaintext highlighter-rouge">Queue</code> to JBoss</li>
  <li>Configure and deploy an ActiveMQ Classic <code class="language-plaintext highlighter-rouge">QueueConnectionFactory</code> to JBoss</li>
  <li>Configure an EJB, deployed to JBoss, to reference the above two.</li>
</ol>

<h3 id="the-bean">The Bean</h3>

<p>In the <a href="outbound-communication.data/ejb-jar.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">ejb-jar.xml</a> deployment descriptor, the <code class="language-plaintext highlighter-rouge">SenderEJB</code> is declared as follows:</p>

<p><strong>ejb-jar.xml – session bean declaration</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;session&gt;
   ...
   &lt;ejb-name&gt;SenderEJB&lt;/ejb-name&gt;
   ...
   &lt;ejb-class&gt;com.panacya.platform.service.bus.sender.SenderBean&lt;/ejb-class&gt;
   ...
   &lt;resource-ref&gt;
      &lt;res-ref-name&gt;jms/MyQueueConnectionFactory&lt;/res-ref-name&gt;
      &lt;res-type&gt;javax.jms.QueueConnectionFactory&lt;/res-type&gt;
      ...
   &lt;/resource-ref&gt;
   &lt;message-destination-ref&gt;
      &lt;message-destination-ref-name&gt;jms/LogQueue&lt;/message-destination-ref-name&gt;
      &lt;message-destination-type&gt;javax.jms.Queue&lt;/message-destination-type&gt;
      ...
      &lt;message-destination-link&gt;LoggingQueue&lt;/message-destination-link&gt;
   &lt;/message-destination-ref&gt;
&lt;/session&gt;
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">jms/MyQueueConnectionFactory</code> is the JNDI name the <code class="language-plaintext highlighter-rouge">SenderEJB</code> will use to lookup a <code class="language-plaintext highlighter-rouge">javax.jms.QueueConnectionFactory</code>. We will configure it to point to an ActiveMQ Classic <code class="language-plaintext highlighter-rouge">QueueConnectionFactory</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">jms/LogQueue</code> is the JNDI name the <code class="language-plaintext highlighter-rouge">SenderEJB</code> will use to lookup the <code class="language-plaintext highlighter-rouge">javax.jms.Queue</code> it will send messages to. We use the <code class="language-plaintext highlighter-rouge">message-destination-link</code> element to refer to the <code class="language-plaintext highlighter-rouge">LoggingQueue</code> which is declared in the <code class="language-plaintext highlighter-rouge">assembly-descriptor</code> section of the <a href="outbound-communication.data/ejb-jar.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">ejb-jar.xml</a> deployment descriptor as:</p>

<p><strong>ejb-jar.xml – assembly descriptor section</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;assembly-descriptor&gt;
   ...
   &lt;message-destination&gt;
      &lt;message-destination-name&gt;LoggingQueue&lt;/message-destination-name&gt;
   &lt;/message-destination&gt;
   ...
&lt;/assembly-descriptor&gt;
</code></pre></div></div>
<p>This is a standard EJB deployment descriptor, nothing special.</p>

<h3 id="the-connector">The Connector</h3>

<p>The <code class="language-plaintext highlighter-rouge">resource-ref</code> element <a href="JBoss Integration/outbound-communication">shown above</a>, will be linked to the following element in the <a href="http://activemq.codehaus.org/checkout/activemq/modules/ra/src/rar/META-INF/ra.xml">ra.xml</a> file, which is contained within the <a href="jboss-integration">activemq-ra-1.2.rar</a> file:</p>

<p><strong>ra.xml – The QueueConnectionFactory</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;outbound-resourceadapter&gt;
   ...
   &lt;connection-definition&gt;
      ...
      &lt;connectionfactory-interface&gt;javax.jms.QueueConnectionFactory&lt;/connectionfactory-interface&gt;
      &lt;connectionfactory-impl-class&gt;org.activemq.ra.ActiveMQConnectionFactory&lt;/connectionfactory-impl-class&gt;
      &lt;connection-interface&gt;javax.jms.QueueConnection&lt;/connection-interface&gt;
      ...
   &lt;/connection-definition&gt;
   ...
&lt;/outbound-resourceadapter&gt;
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">message-destination</code> element <a href="JBoss Integration/outbound-communication">shown above</a>, will be linked to the following element in the <a href="http://activemq.codehaus.org/checkout/activemq/modules/ra/src/rar/META-INF/ra.xml">ra.xml</a> file:</p>

<p><strong>ra.xml – The Queue</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;adminobject&gt;
   &lt;adminobject-interface&gt;javax.jms.Queue&lt;/adminobject-interface&gt;
   &lt;adminobject-class&gt;org.activemq.message.ActiveMQQueue&lt;/adminobject-class&gt;
   &lt;config-property&gt;
      &lt;config-property-name&gt;PhysicalName&lt;/config-property-name&gt;
      &lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
   &lt;/config-property&gt;
&lt;/adminobject&gt;
</code></pre></div></div>

<h3 id="the-glue">The Glue</h3>

<p>In JBoss, connecting the resources needed by the <a href="outbound-communication.data/ejb-jar.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">ejb-jar.xml</a> file to resources provided by the <a href="http://activemq.codehaus.org/checkout/activemq/modules/ra/src/rar/META-INF/ra.xml">ra.xml</a> file involves two additional files:</p>

<ol>
  <li><strong><a href="outbound-communication.data/panacya-jms-ds.xml?version=5&amp;modificationDate=1117021448000&amp;api=v2">panacya-jms-ds.xml</a></strong> - This is a JBoss data source file. It specifies which connector objects JBoss should instantiate and where in JNDI JBoss should place those objects.</li>
  <li><strong><a href="outbound-communication.data/jboss.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">jboss.xml</a></strong> - This is a JBoss deployment descriptor which is contained within the <a href="jboss-integration">panacya-mdb-test-1.0.jar</a> file. It links resources needed by the EJBs to the JNDI names of resources available in JBoss.</li>
</ol>

<h5 id="panacya-jms-dsxml--the-jboss-data-source-file"><a href="outbound-communication.data/panacya-jms-ds.xml?version=5&amp;modificationDate=1117021448000&amp;api=v2">panacya-jms-ds.xml</a> – <em>The JBoss Data Source File</em></h5>

<p>This first snippet configures the <code class="language-plaintext highlighter-rouge">QueueConnectionFactory</code>, <a href="JBoss Integration/outbound-communication">declared above</a>, and places it in JNDI at <code class="language-plaintext highlighter-rouge">activemq/QueueConnectionFactory</code>:</p>

<p><strong>panacya-jms-ds.xml – The QueueConnectionFactory</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;tx-connection-factory&gt;
   &lt;jndi-name&gt;activemq/QueueConnectionFactory&lt;/jndi-name&gt;
   &lt;xa-transaction/&gt;
   &lt;rar-name&gt;activemq-ra-1.2-SNAPSHOT.rar&lt;/rar-name&gt;
   &lt;connection-definition&gt;javax.jms.QueueConnectionFactory&lt;/connection-definition&gt;
   &lt;security-domain-and-application&gt;JmsXARealm&lt;/security-domain-and-application&gt;
&lt;/tx-connection-factory&gt;
</code></pre></div></div>
<p>This second snippet configures the <code class="language-plaintext highlighter-rouge">Queue</code>, <a href="JBoss Integration/outbound-communication">declared above</a>, and places it in JNDI at <code class="language-plaintext highlighter-rouge">activemq/queue/outbound</code>:</p>

<p><strong>panacya-jms-ds.xml – The Queue</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;mbean code="org.jboss.resource.deployment.AdminObject" name="activemq.queue:name=outboundQueue"&gt;
   &lt;attribute name="JNDIName"&gt;activemq/queue/outbound&lt;/attribute&gt;
   &lt;depends optional-attribute-name="RARName"&gt;jboss.jca:service=RARDeployment,name='activemq-ra-1.2-SNAPSHOT.rar'&lt;/depends&gt;
   &lt;attribute name="Type"&gt;javax.jms.Queue&lt;/attribute&gt;
   &lt;attribute name="Properties"&gt;
      PhysicalName=queue.outbound
   &lt;/attribute&gt;
&lt;/mbean&gt;
</code></pre></div></div>
<p>In the <a href="outbound-communication.data/panacya-jms-ds.xml?version=5&amp;modificationDate=1117021448000&amp;api=v2">panacya-jms-ds.xml</a> file section shown above, the value of the <code class="language-plaintext highlighter-rouge">Properties</code> element is set to <code class="language-plaintext highlighter-rouge">PhysicalName=queue.outbound</code>. This value is the physical name of the ActiveMQ Classic destination the <code class="language-plaintext highlighter-rouge">SenderEJB</code> will be sending messages to and not a JNDI name. In other words, the value of the <code class="language-plaintext highlighter-rouge">PhysicalName</code> property has no meaning to JBoss. It is purely an ActiveMQ Classic setting.</p>

<h5 id="jbossxml--the-jboss-deployment-descriptor"><a href="outbound-communication.data/jboss.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">jboss.xml</a> – <em>The JBoss Deployment Descriptor</em></h5>

<p>This first snippet links the <code class="language-plaintext highlighter-rouge">[jms/MyQueueConnectionFactory](JBoss Integration/outbound-communication)</code> JNDI name used by the <code class="language-plaintext highlighter-rouge">SenderEJB</code> to the resource name <code class="language-plaintext highlighter-rouge">queuefactoryref</code> which is local to the <a href="outbound-communication.data/jboss.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">jboss.xml</a> file:</p>

<p><strong>jboss.xml – The QueueConnectionFactory for the SenderEJB</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;enterprise-beans&gt;
   &lt;session&gt;
      &lt;ejb-name&gt;SenderEJB&lt;/ejb-name&gt;
      &lt;resource-ref&gt;
         &lt;res-ref-name&gt;jms/MyQueueConnectionFactory&lt;/res-ref-name&gt;
         &lt;resource-name&gt;queuefactoryref&lt;/resource-name&gt;
      &lt;/resource-ref&gt;
   &lt;/session&gt;
   ...
&lt;/enterprise-beans&gt;
</code></pre></div></div>
<p>This second snippet links the local <code class="language-plaintext highlighter-rouge">queuefactoryref</code> name to the global JNDI name <code class="language-plaintext highlighter-rouge">java:/activemq/QueueConnectionFactory</code> which was <a href="JBoss Integration/outbound-communication">declared above</a>:</p>

<p><strong>jboss.xml – Linking queuefactoryref to the global JNDI namespace</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;resource-managers&gt;
   &lt;resource-manager&gt;
      &lt;res-name&gt;queuefactoryref&lt;/res-name&gt;
      &lt;res-jndi-name&gt;java:/activemq/QueueConnectionFactory&lt;/res-jndi-name&gt;
   &lt;/resource-manager&gt;
   ...
&lt;/resource-managers&gt;
</code></pre></div></div>
<p>This third snippet links the <code class="language-plaintext highlighter-rouge">LoggingQueue</code>, which was <a href="JBoss Integration/outbound-communication">declared</a> in the <code class="language-plaintext highlighter-rouge">assembly-descriptor</code> section of the <a href="outbound-communication.data/ejb-jar.xml?version=3&amp;modificationDate=1117021488000&amp;api=v2">ejb-jar.xml</a>, to the global JNDI name <code class="language-plaintext highlighter-rouge">activemq/queue/outbound</code> which was <a href="JBoss Integration/outbound-communication">declared above</a>:</p>

<p><strong>jboss.xml – Linking LoggingQueue to the global JNDI namespace</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;assembly-descriptor&gt;
   &lt;message-destination&gt;
      &lt;message-destination-name&gt;LoggingQueue&lt;/message-destination-name&gt;
      &lt;jndi-name&gt;activemq/queue/outbound&lt;/jndi-name&gt;
   &lt;/message-destination&gt;
&lt;/assembly-descriptor&gt;
</code></pre></div></div>
<p>The above example highlights the key configuration settings needed to enable EJBs deployed in JBoss to send JMS messages to an ActiveMQ Classic destination.</p>

<p>You can try the above example, plus a few more, by downloading the <a href="outbound-communication.data/activemq-jboss-test.zip?version=3&amp;modificationDate=1117021355000&amp;api=v2">activemq-jboss-test.zip</a> file which contains the complete sample project.</p>

      </div>
    </div>
  </div>
</div>
<div class="row sitemap">
  <div class="col-sm-12">
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <div class="row">
            <div class="col-sm-3">
              <div >
                <img class="float-left" style="max-height: 100px" src="/assets/img/activemq_logo_white_vertical_small.png"/>
              </div>
            </div>
            <div style="text-align: center; margin-bottom: 0px; margin-top: 30px; font-size: 65%" class="col-sm-6">
              <p><a href="https://www.apache.org/foundation/marks/list/">Apache, ActiveMQ, Apache ActiveMQ</a>, the Apache logo, and the Apache ActiveMQ project logo are trademarks of The Apache Software Foundation. Copyright &copy; 2025, The Apache Software Foundation. Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.</p>
            </div>
            <div class="col-sm-3">
              <div >
                <a href="https://www.apache.org"><img class="float-right" style="margin-top: 10px; max-height: 80px" src="/assets/img/Apache_PoweredBy.png"/></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
